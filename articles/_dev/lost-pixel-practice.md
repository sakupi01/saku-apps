---
title: "Lost Pixelã¨Github Actionsã‚’ç”¨ã„ãŸVRTã®å…·ä½“ä¾‹"
excerpt: "æ’®å½±ã—ãŸã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’Githubä¸Šã§ç®¡ç†ã—ã€PRä¸Šã§å·®åˆ†æ¤œçŸ¥ã‚’è¡Œã†ã“ã¨ã§ã€æ„å›³ã›ã¬ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã®ãƒ‡ã‚°ãƒ¬ã‚’é˜²ã„ã§ãã‚Œã‚‹Lost Pixelã®å…·ä½“çš„ãªé‹ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã§ã™"
date: "2024-4-21"
beginColor: 'from-cyan-200'
middleColor: 'via-emerald-300'
endColor: 'to-amber-200'
category: 'dev'
tags: ['lost-pixel', 'vrt', 'testing', 'monorepo']
status: 'published'
---
## ç›®æ¬¡

## ã¯ã˜ã‚ã«
2æœˆã«é–‹å‚¬ã•ã‚ŒãŸ[#vrt4é¸](https://twitter.com/hashtag/VRT4%E9%81%B8)ã¨ã„ã†å‹‰å¼·ä¼šã«å‚åŠ ã—ãŸéš›ã€ãã®ä¸­ã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸLost Pixelã«èˆˆå‘³ã‚’æŒã¡ã¾ã—ãŸã€‚

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">Lost Pixcelã€OSSãƒ¢ãƒ¼ãƒ‰å‰æã ã¨UIã®å·®åˆ†ãŒè¦‹ãŸç›®ã§æ¤œçŸ¥ã—ã«ãã„ä»¥å¤–ã‚ã¡ã‚ƒãã¡ã‚ƒé­…åŠ›çš„ã‹ã‚‚<br>å€‹äººé–‹ç™ºã§Tryã—ã¦ã¿ãŸã¿ãŒã‚ã‚‹<a href="https://twitter.com/hashtag/VRT4%E9%81%B8?src=hash&amp;ref_src=twsrc%5Etfw">#VRT4é¸</a></p>&mdash; saku (@SakuOnTheWeb) <a href="https://twitter.com/SakuOnTheWeb/status/1760260787078357477?ref_src=twsrc%5Etfw">February 21, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

ğŸ‘‡è©²å½“ã®ã‚¹ãƒ©ã‚¤ãƒ‰

https://speakerdeck.com/aiji42/vrtturunodakuhosu-lost-pixelwoshao-jie-sitai

æ™®æ®µã¯å°‚ã‚‰[Chromatic](https://www.chromatic.com/)ãƒ¦ãƒ¼ã‚¶ãªã®ã§ã™ãŒã€å€‹äººé–‹ç™ºã®éš›ç„¡æ–™æ ã®ä¸Šé™ã«ãƒ’ãƒƒãƒˆã—ã¦ç—›ã„ç›®ã«ã‚ã£ãŸéå»ãŒã‚ã‚‹ã®ã§ã€ä»Šå›å€‹äººãƒ–ãƒ­ã‚°ã§ã¯Lost Pixelã§VRTã‚’è¡Œã†ã“ã¨ã«ã—ã¦ã¿ã¾ã—ãŸã€‚

[#vrt4é¸](https://twitter.com/hashtag/VRT4%E9%81%B8)ã§ã¯è©³ç´°ãªå®Ÿè£…ã‚„VRTã®ä¸€é€£ã®æµã‚Œã¾ã§è¿°ã¹ã‚‰ã‚Œã¦ã„ãªã‹ã£ãŸã‹ã¤ã€ã¾ã å›½å†…ã§ã‚ã¾ã‚Šæ™®åŠã—ã¦ãŠã‚‰ãšã€ç™ºè¡¨è€…ã®æ–¹ã®ã‚¹ãƒ©ã‚¤ãƒ‰ä»¥å¤–ã§æ—¥æœ¬èªæ–‡çŒ®ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸãŸã‚ã€ä»Šå›ã¯Lost Pixelã‚’ç”¨ã„ãŸå…·ä½“çš„ãªVRTã®é‹ç”¨æ–¹æ³•ã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚

## å‰æ
å‰æã¨ã—ã¦ã€ã“ã®ãƒ–ãƒ­ã‚°ã¯`/apps/blog`ã«Next.jsè£½ã®ãƒ–ãƒ­ã‚°ã‚¢ãƒ—ãƒªã‚’å«ã‚€ãƒ¢ãƒãƒªãƒæ§‹æˆã§ã§ãã¦ã„ã¾ã™ã€‚

https://www.skr-blog.com/dev/articles/blog-tech-stack


ä»Šå›ã¯ã“ã®`apps/blog`(ãƒ–ãƒ­ã‚°ã‚¢ãƒ—ãƒªéƒ¨åˆ†)ã«Lost Pixelã‚’ç”¨ã„ãŸVRTã‚’æ–½ã—ã¦ã„ãã¾ã™ã€‚

## Lost Pixelã¨ã¯
Lost Pixelã¨ã¯ã€VRT(Visual Regression Test, ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å›å¸°ãƒ†ã‚¹ãƒˆ)ã‚’è¡Œã†ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

https://www.lost-pixel.com/

é‡è¤‡ã—ãŸèª¬æ˜ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ã“ã“ã§ã¯ç°¡å˜ãªèª¬æ˜ã«æ­¢ã‚ã¦è©³ç´°ã¯[ã‚¹ãƒ©ã‚¤ãƒ‰](https://speakerdeck.com/aiji42/vrtturunodakuhosu-lost-pixelwoshao-jie-sitai)ã‚„[Zennã®è¨˜äº‹](https://zenn.dev/aiji42/articles/6656072a954a9b)ã«è­²ã‚ŠãŸã„ã¨æ€ã„ã¾ã™ã€‚

ä»Šå›å®Ÿéš›ã«Lost Pixelã§VRTã‚’é‹ç”¨ã—ã¦ã¿ã¦å€‹äººçš„ã«æ„Ÿã˜ãŸã“ã¨ã¨ã—ã¦ã¯ã€

â­ï¸ãƒ¡ãƒªãƒƒãƒˆ
- OSSãƒ¢ãƒ¼ãƒ‰ã ã¨ã€Githubã‚’ãƒ•ãƒ«æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ç„¡æ–™ã§VRTã§ãã‚‹åŸºç›¤ãŒä½œã‚Œã‚‹
- Storybookã‚„Ladle, Histoire, ãƒšãƒ¼ã‚¸å˜ä½ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€Cypressã‚„Playwrightã‚’ç”¨ã„ãŸã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãªã©æ§˜ã€…ãªæ’®å½±æ–¹æ³•ãŒå¯èƒ½
- PRãƒ¬ãƒ“ãƒ¥ãƒ¼ã®éš›ã«è‡ªç„¶ã«è¦‹ãŸç›®ã®å·®åˆ†ãƒã‚§ãƒƒã‚¯ãŒè¡Œãˆã‚‹ä»•çµ„ã¿ãŒä½œã‚Œã‚‹
- ãƒã‚¹ã‚­ãƒ³ã‚°æ©Ÿèƒ½ãŒã‚ã‚Šä¾¿åˆ©


â­ï¸ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- CIã‚’çµ„ã‚€ã®ãŒè‹¦æ‰‹ã ã¨ã€æ€ã„é€šã‚Šã®é‹ç”¨ãŒé›£ã—ãã€è¾›ã„

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«é©ç”¨
ã¾ãšã€ä»Šå›ã®ã‚·ãƒŠãƒªã‚ªã¨ã—ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ãƒ³ãƒ: `main`, Lost Pixelã‚’å–ã‚Šå…¥ã‚Œã‚‹ãŸã‚ã®ãƒ–ãƒ©ãƒ³ãƒ: `feat/lost-pixel`ãŒã‚ã‚‹ã¨ã—ã¾ã—ã‚‡ã†ã€‚

ã¾ãŸã€ä»Šå›ã¯ãƒ¢ãƒãƒªãƒã®`apps/blog`ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãƒ–ãƒ­ã‚°ã‚¢ãƒ—ãƒªãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ã€**ãƒšãƒ¼ã‚¸å˜ä½ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ**ã‚’æ’®ã‚‹ã“ã¨ã§UIå·®åˆ†æ¯”è¼ƒã—ã¦ã„ãã¾ã™ã€‚

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ãƒšãƒ¼ã‚¸å˜ä½ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®ãŸã‚ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®Page shotséƒ¨åˆ†ã‚’å‚ç…§ã—ã¾ã™ã€‚
https://docs.lost-pixel.com/user-docs/setup/project-configuration/modes#page-shots

ãƒ™ãƒ¼ã‚¹ã¯ã“ã‚Œã§ã™ãŒã€ä»Šå›ã¯ãƒ¢ãƒãƒªãƒã‹ã¤CIã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’åŠ å‘³ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã‚’åŠ ãˆã¦ã„ã¾ã™ã€‚

<details>

```ts showLineNumbers {7} title="lostpixel.config.ts"
import { CustomProjectConfig } from "lost-pixel";

export const config: CustomProjectConfig = {
  pageShots: {
    pages: [
      { path: "/", name: "home" },
      { path: "/about", name: "about" },
      { path: "/dev", name: "dev" },
      { path: "/dev/articles/blog-tech-stack", name: "blog-tech-stack" },
      { path: "/dev/tag/react", name: "tag-react" },
      {
        path: "/life", // ğŸŸ¢ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®ã‚‹ãƒšãƒ¼ã‚¸ã®path
        name: "life", // ğŸŸ¢ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®åå‰
        threshold: 0.004, // ğŸŸ¢é–¾å€¤ã€‚ã©ã®ãã‚‰ã„ã®ã‚ºãƒ¬ã¾ã§è¨±å®¹ã™ã‚‹ã‹
        mask: [{ selector: ".eye-catch" }], // ğŸŸ¢ãƒã‚¹ã‚¯ã‚’ã‹ã‘ã‚‹ã‚»ãƒ¬ã‚¯ã‚¿
      },
      {
        path: "/life/articles/intern-completed-aritcle",
        name: "intern-completed-article",
        mask: [{ selector: ".thumbnail" }],
      },
      {
        path: "/life/tag/poem",
        name: "poem",
        threshold: 0.006,
        mask: [{ selector: ".eye-catch" }],
      },
    ],
    // ğŸŸ¢ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã‚‹ã¨ãã®IPã¯localhostã§ã€Github Actionã§å®Ÿè¡Œã™ã‚‹ã¨ãã®IPã¯172.17.0.1ã«è¨­å®šã™ã‚‹
    baseUrl: process.env.LOCAL
      ? "http://localhost:3000"
      : "http://172.17.0.1:3000",
  },
  waitBeforeScreenshot: 5000,// ğŸŸ¢
  timeouts: {
    loadState: 50000, // ğŸŸ¢
    networkRequests: 50000, // ğŸŸ¢
  },
  
  // OSS mode
  // ğŸŸ¢ãƒ¢ãƒãƒªãƒã®å ´åˆã€Github Actionã§å®Ÿè¡Œã™ã‚‹ã¨ãã®ãƒ‘ã‚¹ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®rootã‹ã‚‰ã®ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹
  imagePathBaseline: process.env.LOCAL // ğŸŸ¢baselineã‚¤ãƒ¡ãƒ¼ã‚¸ã®æ ¼ç´å…ˆã€‚ã“ã“ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãŒæ¯”è¼ƒåŸºæº–
    ? "./tests/vrt/baseline-images"
    : "./apps/blog/tests/vrt/baseline-images",
  imagePathCurrent: process.env.LOCAL // ğŸŸ¢currentã‚¤ãƒ¡ãƒ¼ã‚¸ã®æ ¼ç´å…ˆã€‚ç¾çŠ¶ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã®ã‚­ãƒ£ãƒ—ãƒãƒ£ã§ã€baselineã¨æ¯”è¼ƒã•ã‚Œã‚‹
    ? "./tests/vrt/current-images"
    : "./apps/blog/tests/vrt/current-images",
  imagePathDifference: process.env.LOCAL // ğŸŸ¢differenceã‚¤ãƒ¡ãƒ¼ã‚¸ã®æ ¼ç´å…ˆã€‚currentImageã¨baselineImageã®å·®åˆ†ç”»åƒ
    ? "./tests/vrt/difference-images"
    : "./apps/blog/tests/vrt/difference-images",
  generateOnly: true,

  // ğŸŸ¢baselineã¨currentã«å·®åˆ†ãŒã‚ã‚‹æ™‚ã¯å®Ÿè¡Œçµæœã‚’failã¨ã—ã¦ãƒãƒ¼ã‚¯
  failOnDifference: true,
};
```
</details>

#### 0. ãƒ­ãƒ¼ã‚«ãƒ«ã§å·®åˆ†ç¢ºèªã™ã‚‹
ãã‚Œã§ã¯ã€æ—©é€Ÿæ‰‹å…ƒã®ç’°å¢ƒã§å·®åˆ†ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼


#### 1. baselineã‚’updateã™ã‚‹

#### 2. ã‚‚ã†ä¸€åº¦å·®åˆ†ç¢ºèªã‚’ã™ã‚‹

base-images
current-images 
diff-images 0

#### 3. Workflowã‚’ä½œæˆã™ã‚‹
ã“ã®CI workflowã‚’ä½œæˆã™ã‚‹ã®ã«å¤šãã®æ™‚é–“ã‚’æ¶ˆè²»ã—ã¾ã—ãŸã€‚ç§ã¯CIã«ã¨ã¦ã‚‚å¼±ã„ã§ã™ã€‚

CIã‚¹ãƒ‘ã‚¹ãƒ‘ä½œã‚Œã‚‹äººã€…ã‹ã£ã“ã„ã„ã€‚ã€‚ã€‚

##### 3.1 å·®åˆ†ç¢ºèªã®ãŸã‚ã®Workflow(vis-reg-test.yml)
<details>

```yaml showLineNumbers {7} title="vis-reg-test.yml"
name: Visual Regression Test

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      TURBO_TOKEN: ${{ secrets.TURBO_TOKEN }}
      TURBO_TEAM: ${{ vars.TURBO_TEAM }}
    steps:
      - name: Checkout Commit
        uses: actions/checkout@v4
        with:
          fetch-depth: 2

      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - name: Install dependencies
        run: bun install
      - name: Cache bun dependencies
        uses: actions/cache@v3
        id: bun-cache
        with:
          path: node_modules
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun
  lost-pixel:
    needs: build
    runs-on: ubuntu-latest
    strategy:
        matrix:
          config:
            - {
                package: "apps/blog",
                name: "Lost Pixel for blog page",
                command: "bun run start",
              }
    defaults:
        run:
            working-directory: ${{ matrix.config.package }}
    env:
      TURBO_TOKEN: ${{ secrets.TURBO_TOKEN }}
      TURBO_TEAM: ${{ vars.TURBO_TEAM }}
    steps:
      - name: Checkout Commit
        uses: actions/checkout@v4
        with:
          fetch-depth: 2
          
      - name: Create .env file
        run: |
            touch .env
            echo "ZENN_URL=${{ secrets.ZENN_URL }}" >> .env
            echo "ZENN_BASE_URL=${{ secrets.ZENN_BASE_URL }}" >> .env

      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest

      - name: Restore bun dependencies
        id: bun-cache
        uses: actions/cache@v3
        with:
          path: node_modules
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun

      - name: Build UI
        working-directory: ./packages/ui
        run: bun run build 

      - name: Build App
        run: cd ../../ && bun run build 

      - name: Start App
        run: cd . && ${{ matrix.config.command }} &
    
      - name: Lost Pixel
        id: lostpixel
        uses: lost-pixel/lost-pixel@v3.16.0
        env:
            LOST_PIXEL_DISABLE_TELEMETRY: 1
            LOST_PIXEL_CONFIG_DIR: ${{ matrix.config.package }}
```
</details>

##### 3.2 baselineæ›´æ–°ã®ãŸã‚ã®Workflow(update-vrt.yml)
<details>

```yaml showLineNumbers {7} title="update-vrt.yml"
# https://zenn.dev/aiji42/articles/6656072a954a9b
name: Visual Regression Testing Update By PR Comment

on:
  issue_comment:
    types: [created, edited]

jobs:

  lost-pixel:
    if: contains(github.event.comment.html_url, '/pull/') && startsWith(github.event.comment.body, '/update-vrt')
    name: ğŸ“¸ Lost Pixel Baseline Update By PR Comment
    runs-on: ubuntu-latest
    env:
      TURBO_TOKEN: ${{ secrets.TURBO_TOKEN }}
      TURBO_TEAM: ${{ vars.TURBO_TEAM }}
    permissions:
      contents: write
      pull-requests: write

    strategy:
      matrix:
        config:
          - { package: "apps/blog", name: "Lost Pixel for blog page", command: "bun run start" }

    defaults:
      run:
        working-directory: ${{ matrix.config.package }}

    steps:
      - name: Get branch name
        uses: xt0rted/pull-request-comment-branch@v2
        id: comment-branch
        with:
          repo_token: ${{ secrets.GITHUB_TOKEN }}

      - name: Checkout Commit
        uses: actions/checkout@v3
        with:
          ref: ${{ steps.comment-branch.outputs.head_ref }}
          fetch-depth: 0

          
      - name: Create .env file
        run: |
              touch .env
              echo "ZENN_URL=${{ secrets.ZENN_URL }}" >> .env
              echo "ZENN_BASE_URL=${{ secrets.ZENN_BASE_URL }}" >> .env

      - name: Setup Git User
        run: |
          git config --global user.name 'GitHub Actions'
          git config --global user.email 'github-actions@github.com'

      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest

      - name: Install dependencies
        run: cd ../../ && bun install

      - name: Build UI
        working-directory: ./packages/ui
        run: bun run build

      - name: Build App
        run: cd ../../ && bun run build

      - name: Start App
        run: cd . && ${{ matrix.config.command }} &

      - name: Lost Pixel Update
        id: lostpixel
        uses: lost-pixel/lost-pixel@v3.16.0
        env:
          LOST_PIXEL_MODE: update
          LOST_PIXEL_DISABLE_TELEMETRY: 1
          LOST_PIXEL_CONFIG_DIR: ${{ matrix.config.package }}

      - name: Lost Pixel
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' }}
        uses: lost-pixel/lost-pixel@v3.16.0
        env:
          LOST_PIXEL_DISABLE_TELEMETRY: 1
          LOST_PIXEL_CONFIG_DIR: ${{ matrix.config.package }}

      - name: Give Permission to untracked files
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' }}
        run: sudo chown -R $USER:$USER .
      
      - name: Check existing Lost Pixel PR
        id: check-pr
        run: |
          existing_pr=$(gh pr list --base ${{ steps.comment-branch.outputs.head_ref }} --label update-lost-pixel --json number,head.ref --jq '.[] | select(.head.ref | startswith("lost-pixel-update/")) | .number')
          echo "::set-output name=pr_number::$existing_pr"

      - name: Create new branch
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' && steps.check-pr.outputs.pr_number == '' }}
        run: |
          git checkout -b lost-pixel-update/${{ steps.comment-branch.outputs.head_ref }}

      - name: Checkout existing PR branch
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' && steps.check-pr.outputs.pr_number != '' }}
        run: |
          git checkout lost-pixel-update/${{ steps.comment-branch.outputs.head_ref }}

      - name: Add untracked files
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' }}
        run: |
          git add .

      - name: Create commit
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' }}
        run: |
          git commit -m "Update VRT baseline images" || echo "No changes to commit"

      - name: Push changes
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' }}
        run: |
          git push origin HEAD:lost-pixel-update/${{ steps.comment-branch.outputs.head_ref }} --force

      - name: Create Pull Request
        if: ${{ failure() && steps.lostpixel.conclusion == 'failure' && steps.check-pr.outputs.pr_number == '' }}
        run: |
          gh pr create --base ${{ steps.comment-branch.outputs.head_ref }} \
                       --head lost-pixel-update/${{ steps.comment-branch.outputs.head_ref }} \
                       --label update-lost-pixel \
                       --title 'Lost Pixel Update - ${{ steps.comment-branch.outputs.head_ref }}' \
                       --body 'Automated baseline update created by Lost Pixel'
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```
</details>

#### 4. update-vrt.ymlã‚’mainãƒ–ãƒ©ãƒ³ãƒã«å–ã‚Šè¾¼ã‚€


#### 5. `feat/lost-pixel`ã®PRã‚’ä½œæˆã™ã‚‹

### é‹ç”¨ã™ã‚‹

#### 6. vis-reg-test.ymlã‚’å›ã™

##### 6.1 Failã®ã¨ã 
`/update-vrt`ã¨PRã«ã‚³ãƒ¡ãƒ³ãƒˆã—ã¾ã™ã€‚ã™ã‚‹ã¨ã€å…ˆã»ã©å®šç¾©ã—ãŸ`update-vrt.yml`ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã¾ã™ã€‚

:::note{.warning}
â— Warning
<br/>
issue_commentã¯ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ã¡ãƒ¼ãƒ¼ãƒ¼
:::

ã“ã‚Œã«ã‚ˆã‚Šã€baselineã®updateã‚’ã™ã‚‹ãŸã‚ã®ãƒ–ãƒ©ãƒ³ãƒ`lost-pixel-update/[base-pr-name]`ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥ã‚ŒãŸPR(ã“ã“ã§ã¯`feat/lost-pixel`)ã‹ã‚‰ç”Ÿãˆã‚‹å½¢ã§ä½œæˆã•ã‚Œã€ã‚¿ã‚¤ãƒˆãƒ«ãŒã€ŒLost Pixel Update - [base-branch-name]ã€PRã‚‚ä½œæˆã•ã‚Œã¾ã™ã€‚

ã“ã“ã§ã€ä½œæˆã•ã‚ŒãŸPRã®Changeséƒ¨åˆ†ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã€Githubä¸Šã§è¦–è¦šçš„ã«è¦‹ãŸç›®ã®å¤‰åŒ–ã‚’æ‰ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ğŸ‘‡å¾®ã€…ãŸã‚‹å¤‰åŒ–ã€‚ã“ã®å ´åˆã€ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚„å®Ÿè¡Œç’°å¢ƒã®å·®ç•°ãŒåŸå› ã§ã‚ã‚‹ã¨æ€ã‚ã‚Œã‚‹ã€‚

â†’[ã‚¹ãƒ†ãƒƒãƒ—6.1.1ã¸]()


ğŸ‘‡è¦‹ãŸç›®ã®å¤§ããªå¤‰åŒ–ã€‚ã“ã®å ´åˆã€ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã«ä½•ã‚‰ã‹ã®å•é¡ŒãŒã‚ã‚‹ã¨æ€ã‚ã‚Œã‚‹ã€‚

â†’[ã‚¹ãƒ†ãƒƒãƒ—6.1.2ã¸]()

<br />

###### 6.1.1 è¨±å®¹å¯èƒ½ãªè¦‹ãŸç›®ã®å¤‰åŒ–ã®ã¨ã
PRã®å·®åˆ†ã‚’ç¢ºèªã—ãŸçµæœã€è¨±å®¹å¯èƒ½ãªè¦‹ãŸç›®ã®å¤‰åŒ–ã®æ™‚ã¯ã€ã‚³ãƒ¡ãƒ³ãƒˆå…ƒã®ãƒ–ãƒ©ãƒ³ãƒ(`feat/lost-pixel`)ã®baselineã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã„ã§ã™ã€‚
ãã†ã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¡ãƒ³ãƒˆå…ƒã®ãƒ–ãƒ©ãƒ³ãƒ(`feat/lost-pixel`)ã§ã‚‚ã†ä¸€åº¦`vis-reg-test.yml`ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å›ã—ã¦ãƒ†ã‚¹ãƒˆã‚’passã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‰ã§ã™ã€‚

ãªã®ã§ã€`lost-pixel-update/[base-pr-name]`ãƒ–ãƒ©ãƒ³ãƒã®ã€ŒLost Pixel Update - [base-branch-name]ã€PRã‚’ãƒãƒ¼ã‚¸ã—ã¾ã—ã‚‡ã†ï¼

ã™ã‚‹ã¨ã€ã‚³ãƒ¡ãƒ³ãƒˆå…ƒã®ãƒ–ãƒ©ãƒ³ãƒ(`feat/lost-pixel`)ã§ã‚‚ã†ä¸€åº¦`vis-reg-test.yml`ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå‘¨ã‚Šã€ä»Šåº¦ã¯updateã•ã‚ŒãŸbaselineã¨ã®æ¯”è¼ƒãŒè¡Œã‚ã‚Œã‚‹ãŸã‚ã€ãƒ†ã‚¹ãƒˆã‚’passã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

â†’[ã‚¹ãƒ†ãƒƒãƒ—6.2ã¸]()

<br />

###### 6.1.2 è¨±å®¹ä¸å¯èƒ½ãªè¦‹ãŸç›®ã®å¤‰åŒ–ã®ã¨ã
ã‚³ãƒ¡ãƒ³ãƒˆå…ƒã®ãƒ–ãƒ©ãƒ³ãƒ(`feat/lost-pixel`)ã«æˆ»ã£ã¦ã€è¦‹ãŸç›®ã‚’æƒãˆã‚‹ãŸã‚ã®ä¿®æ­£ã‚³ãƒŸãƒƒãƒˆã‚’åŠ ãˆã€å†åº¦pushã—ã¾ã™ã€‚

â†’[ã‚¹ãƒ†ãƒƒãƒ—6ã¸]()

##### 6.2 Successã®ã¨ã
ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã“ã‚Œã§è¦‹ãŸç›®ãŒç¢ºèªã•ã‚ŒãŸå¤‰æ›´ã‚’ãƒãƒ¼ã‚¸ã§ãã¾ã™ğŸ’¯

```json showLineNumbers {7} title="turbo.json"
{
    "$schema": "https://turbo.build/schema.json",
    "globalDependencies": ["**/.env.*local"],
    "pipeline": {
        "build": {
            "dependsOn": ["^build"],
            "outputs": [".next/**", "!.next/cache/**"]
        },
        "test": {
            "dependsOn": ["^build"]
        },
        ...
    }
    ...
}
```
